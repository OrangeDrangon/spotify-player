(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,a){e.exports=a.p+"static/media/skip_next.cf9d95de.svg"},102:function(e,t,a){e.exports=a.p+"static/media/skip_previous.9bb6aca1.svg"},103:function(e,t,a){e.exports=a.p+"static/media/shuffle_active.8df07479.svg"},104:function(e,t,a){e.exports=a.p+"static/media/shuffle_inactive.2cca4185.svg"},105:function(e,t,a){e.exports=a.p+"static/media/play.e89c0883.svg"},106:function(e,t,a){e.exports=a.p+"static/media/pause.ec371d86.svg"},107:function(e,t,a){e.exports=a.p+"static/media/repeat_inactive.a5b97110.svg"},108:function(e,t,a){e.exports=a.p+"static/media/repeat_one.7583cdf3.svg"},109:function(e,t,a){e.exports=a.p+"static/media/repeat_active.63f00651.svg"},110:function(e,t,a){e.exports=a(187)},119:function(e,t,a){},14:function(e,t,a){e.exports={container:"Player_container__38UHD",controls:"Player_controls__1aBpr",information:"Player_information__1-7eW",words:"Player_words__1PMPb",nowPlaying:"Player_nowPlaying__17VFv",buttons:"Player_buttons__EtbQ8",slider:"Player_slider__2NOIK",time:"Player_time__xzbfe",volume:"Player_volume__2GkGB",iconButton:"Player_iconButton__ysgAB"}},187:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(8),o=a.n(c),s=a(11),i=(a(119),a(120),a(41)),l=a(24),u=a(54),d=a.n(u),m=a(91),p=a.n(m),f=a(92),b=a.n(f),v=function(){return r.a.createElement("header",{className:b.a.header},r.a.createElement(i.b,{to:"/featured",className:"styled-button"},"Featured"),r.a.createElement(i.b,{to:"/personal",className:"styled-button"},"Personal"))},_=a(6),k=a.n(_),h=a(12);function y(e,t){return w.apply(this,arguments)}function w(){return(w=Object(h.a)(k.a.mark(function e(t,a){var n,r;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=14;break}return e.prev=1,e.next=4,fetch(t,{method:"GET",headers:[["Authorization","Bearer ".concat(a)]]});case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",(n.status,r));case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}},e,null,[[1,11]])}))).apply(this,arguments)}var E=a(13),g=a(94),j=a.n(g),O=a(21),x=a.n(O),N=a(95),P=a.n(N),C=a(96),S=a.n(C),B=function(e){var t=e.children,a=e.containerClass;return r.a.createElement("div",{className:"".concat(S.a.container," ").concat(a||"")},t)},T=a(97),D=a.n(T),U=function(e){var t=e.children,a=e.open,n=e.onBackdropClick;return r.a.createElement("div",{className:D.a.backdrop,onClick:function(e){e.target===e.currentTarget&&n()},style:a?{}:{display:"none"}},t)},A=a(42),M=a(43),W=a(32),I=a.n(W),L=a(45),z=a.n(L),R=Object(s.b)(function(e){return{token:e.token,device_id:e.device_id}})(function(e){var t=e.track,a=e.token,c=e.playlistUri,o=e.device_id,s=Object(n.useCallback)(Object(h.a)(k.a.mark(function e(){var n;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!o||!a){e.next=4;break}return n={context_uri:c,offset:{uri:t.uri}},e.next=4,fetch("https://api.spotify.com/v1/me/player/play?device_id=".concat(o),{method:"PUT",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}});case 4:case"end":return e.stop()}},e)})),[a,t,c,o]);return r.a.createElement("div",{className:z.a.row},r.a.createElement("div",{className:z.a.elm},r.a.createElement("div",{className:z.a.artist,onClick:s},t.name)),r.a.createElement("div",{className:z.a.elm},t.artists[0].name))}),F=Object(s.b)(function(e){return{token:e.token}})(function(e){var t=e.token,a=e.tracks,c=e.playlistUri,o=Object(n.useState)(a),s=Object(E.a)(o,2),i=s[0],l=s[1],u=Object(n.useState)(Object(M.a)({},i.href,i)),d=Object(E.a)(u,2),m=d[0],p=d[1],f=Object(n.useCallback)(function(){var e=Object(h.a)(k.a.mark(function e(a){var n,r,c;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=i[a])){e.next=10;break}if(!(r=m[n])){e.next=6;break}return l(r),e.abrupt("return");case 6:return e.next=8,y(n,t);case 8:(c=e.sent).status||(c=c,p(Object(A.a)({},m,Object(M.a)({},c.href,c))),l(c));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[i,t,m]);return r.a.createElement("div",{className:I.a.table},r.a.createElement("div",{className:I.a.header},r.a.createElement("div",{className:I.a.title},"Song"),r.a.createElement("div",{className:I.a.title},"Artist")),r.a.createElement("div",{className:I.a.content},i.items.map(function(e){return e.track?r.a.createElement(R,{key:e.track.id+Math.random(),track:e.track,playlistUri:c}):r.a.createElement("div",{key:Math.random()},"Loading...")})),i.next||i.previous?r.a.createElement("div",{className:I.a.buttons},i.previous?r.a.createElement("button",{className:"styled-button",onClick:function(){return f("previous")}},"Previous"):r.a.createElement("button",{className:"styled-button",disabled:!0},"Previous"),i.next?r.a.createElement("button",{className:"styled-button",onClick:function(){return f("next")}},"Next"):r.a.createElement("button",{className:"styled-button",disabled:!0},"Next")):"")}),H=Object(s.b)(function(e){return{token:e.token}})(function(e){var t,a=e.href,c=e.token,o=Object(n.useState)(null),s=Object(E.a)(o,2),i=s[0],l=s[1],u=Object(n.useState)(!1),d=Object(E.a)(u,2),m=d[0],p=d[1],f=Object(n.useCallback)(Object(h.a)(k.a.mark(function e(){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(a,c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),[a,c]);return Object(n.useEffect)(function(){var e=!1;return Object(h.a)(k.a.mark(function t(){var a,n;return k.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:(a=t.sent)&&(a.status||(n=a,e||l(n)));case 4:case"end":return t.stop()}},t)}))(),function(){e=!0}},[f]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:x.a.cover,onClick:function(){return p(!0)},style:i?{backgroundImage:"url(".concat(i.images[0].url,")")}:{}}),m?r.a.createElement(U,{open:m,onBackdropClick:function(){return p(!1)}},r.a.createElement(B,{containerClass:x.a.card},r.a.createElement("img",{src:P.a,alt:"",className:x.a.close,onClick:function(){return p(!1)}}),i?r.a.createElement("div",{className:x.a.wrapper},r.a.createElement("header",{className:x.a.header},r.a.createElement("h1",{className:x.a.title},i.name),r.a.createElement("div",{className:x.a.createdBy},"Created by"," ",r.a.createElement("span",{className:x.a.author},i.owner.display_name)),r.a.createElement("div",{className:x.a.description},(t=i.description?i.description:"",(new DOMParser).parseFromString(t,"text/html").documentElement.textContent))),r.a.createElement("div",{className:x.a.lineBreak}),r.a.createElement("section",{className:x.a.section},r.a.createElement(F,{tracks:i.tracks,playlistUri:i.uri}))):"Loading...")):"")}),J=function(e){var t=e.getSimple,a=Object(n.useState)(null),c=Object(E.a)(a,2),o=c[0],s=c[1];return Object(n.useEffect)(function(){var e=!1;return Object(h.a)(k.a.mark(function a(){var n,r;return k.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t();case 2:(n=a.sent)&&(n.status||(r=n,e||s(r)));case 4:case"end":return a.stop()}},a)}))(),function(){e=!0}},[t]),r.a.createElement("div",{className:j.a.container},(o?o.items:[]).map(function(e){return r.a.createElement(H,{key:e.id,href:e.href})}))},Q=Object(s.b)(function(e){return{token:e.token}})(function(e){var t=e.token,a=Object(n.useCallback)(Object(h.a)(k.a.mark(function e(){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("https://api.spotify.com/v1/me/playlists",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),[t]);return r.a.createElement(J,{getSimple:a})}),V=Object(s.b)(function(e){return{token:e.token}})(function(e){var t=e.token,a=Object(n.useCallback)(Object(h.a)(k.a.mark(function e(){var a;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("https://api.spotify.com/v1/browse/featured-playlists",t);case 2:return a=e.sent,e.abrupt("return",a?a.status?a:a.playlists:null);case 4:case"end":return e.stop()}},e)})),[t]);return r.a.createElement(J,{getSimple:a})}),G=Object(s.b)(null,function(e){return{setToken:function(t){return e({type:"setToken",payload:t})}}})(function(e){var t=e.setToken,a=Object(n.useState)(null),c=Object(E.a)(a,2),o=c[0],s=c[1];return Object(n.useEffect)(function(){var e=!1,a=null,n=d.a.parse(window.location.hash);if(n.access_token){var r=n;e||(t(r.access_token),a=setTimeout(function(){return t(null)},1e3*Number(r.expires_in))),r.state&&s(r.state)}return function(){e=!0,a&&clearTimeout(a)}},[t]),o?r.a.createElement(l.a,{to:o}):r.a.createElement("div",null,"Redirecting...")}),K=a(76),X=a(14),Z=a.n(X),q=a(101),Y=a.n(q),$=a(102),ee=a.n($),te=a(103),ae=a.n(te),ne=a(104),re=a.n(ne),ce=a(105),oe=a.n(ce),se=a(106),ie=a.n(se),le=a(107),ue=a.n(le),de=a(108),me=a.n(de),pe=a(109),fe=a.n(pe),be=function(e){switch(e){case 0:return["context",1];case 1:return["track",2];case 2:default:return["off",0]}},ve=Object(K.a)(K.b),_e=Object(s.b)(function(e){return{token:e.token,device_id:e.device_id}},function(e){return{setDeviceId:function(t){return e({type:"setDeviceId",payload:t})}}})(function(e){var t=e.token,a=e.device_id,c=e.setDeviceId,o=Object(n.useState)(!0),s=Object(E.a)(o,2),i=s[0],l=s[1],u=Object(n.useState)(null),d=Object(E.a)(u,2),m=d[0],p=d[1],f=Object(n.useState)(null),b=Object(E.a)(f,2),v=b[0],_=b[1],y=Object(n.useState)(!1),w=Object(E.a)(y,2),g=w[0],j=w[1],O=Object(n.useState)(0),x=Object(E.a)(O,2),N=x[0],P=x[1],C=Object(n.useState)(0),S=Object(E.a)(C,2),B=S[0],T=S[1],D=Object(n.useCallback)(Object(h.a)(k.a.mark(function e(){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.spotify.com/v1/me/player/shuffle?state=".concat(!g),{method:"PUT",headers:{authorization:"Bearer ".concat(t)}});case 2:j(!g);case 3:case"end":return e.stop()}},e)})),[t,g]),U=Object(n.useCallback)(Object(h.a)(k.a.mark(function e(){var a,n,r,c;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=be(N),n=Object(E.a)(a,2),r=n[0],c=n[1],e.next=3,fetch("https://api.spotify.com/v1/me/player/repeat?state=".concat(r),{method:"PUT",headers:{authorization:"Bearer ".concat(t)}});case 3:P(c);case 4:case"end":return e.stop()}},e)})),[t,N]),A=Object(n.useRef)(null);return Object(n.useEffect)(function(){if(window.Spotify&&t&&!a&&!m){var e=new window.Spotify.Player({name:"Drangon's Web Player",volume:1,getOAuthToken:function(e){return e(t)}});e.addListener("ready",function(e){var t=e.device_id;c(t)}),e.addListener("player_state_changed",function(e){e&&(l(e.paused),j(e.shuffle),P(e.repeat_mode),e.track_window&&e.track_window.current_track&&_(e.track_window.current_track),T(e.position))}),e.connect(),p(e)}},[a,t,c,m]),Object(n.useEffect)(function(){A.current&&(A.current.value=(B/1e3).toString())},[B]),Object(n.useEffect)(function(){if(!i&&v){var e=setInterval(function(){return T(function(e){return e+1e3})},1e3);return function(){clearInterval(e)}}},[i,v]),r.a.createElement("div",{className:Z.a.container},m&&a?r.a.createElement("div",{className:Z.a.controls},v?r.a.createElement("div",{className:Z.a.information},r.a.createElement("img",{src:v.album.images[1].url,alt:""}),r.a.createElement("div",{className:Z.a.words},r.a.createElement("div",{className:Z.a.trackName},v.name),r.a.createElement("div",{className:Z.a.artist},v.artists[0].name))):"",r.a.createElement("div",{className:Z.a.nowPlaying},r.a.createElement("div",{className:Z.a.buttons},r.a.createElement("button",{className:"styled-button ".concat(Z.a.iconButton),onClick:D},r.a.createElement("img",{src:g?ae.a:re.a,alt:""})),r.a.createElement("button",{className:"styled-button ".concat(Z.a.iconButton),onClick:function(){return m.previousTrack()}},r.a.createElement("img",{src:ee.a,alt:""})),r.a.createElement("button",{className:"styled-button ".concat(Z.a.iconButton),onClick:function(){m.togglePlay()}},r.a.createElement("img",{src:i?oe.a:ie.a,alt:""})),r.a.createElement("button",{className:"styled-button ".concat(Z.a.iconButton),onClick:function(){return m.nextTrack()}},r.a.createElement("img",{src:Y.a,alt:""}))," ",r.a.createElement("button",{className:"styled-button ".concat(Z.a.iconButton),onClick:function(){return U()}},r.a.createElement("img",{src:0===N?ue.a:1===N?fe.a:me.a,alt:""}))),v?r.a.createElement("div",{className:Z.a.slider},r.a.createElement("input",{type:"range",min:0,max:Math.floor(v.duration_ms/1e3),step:1,ref:A,onChange:function(e){var t=e.currentTarget;return m.seek(1e3*Number(t.value))}}),r.a.createElement("div",{className:Z.a.time},new Date(B).getMinutes(),":",new Date(B).getSeconds()<10?"0".concat(new Date(B).getSeconds()):new Date(B).getSeconds(),"/",new Date(v.duration_ms).getMinutes(),":",new Date(v.duration_ms).getSeconds()<10?"0".concat(new Date(v.duration_ms).getSeconds()):new Date(v.duration_ms).getSeconds())):""),r.a.createElement(ve,{className:Z.a.volume,defaultValue:100,min:0,max:100,step:1,onChange:function(e){return m.setVolume(e/100)},tipFormatter:function(e){return"".concat(e,"%")}})):r.a.createElement("div",null,"Loading..."))}),ke=Object(s.b)(function(e){return{token:e.token,device_id:e.device_id}})(function(e){var t=e.token;return Object(n.useEffect)(function(){if(!t&&!d.a.parse(window.location.hash).access_token){var e={client_id:"7ff4c2742b1d4e91b297c2ef6bf8d041",redirect_uri:"https://player.kmr.pw/callback",response_type:"token",scopes:["streaming","user-read-birthdate","user-read-email","user-read-private","playlist-read-private","user-modify-playback-state"],state:window.location.pathname};window.location.assign(function(e){var t=e.client_id,a=e.redirect_uri,n=e.response_type,r=e.scopes,c=e.show_dialog,o=e.state;return"https://accounts.spotify.com/authorize?client_id=".concat(t,"&redirect_uri=").concat(encodeURIComponent(a),"&scope=").concat(r?r.join(" "):"","&response_type=").concat(n,"&state=").concat(o||"","&show_dialog=").concat(c||"false")}(e))}},[t]),r.a.createElement(i.a,null,r.a.createElement(v,null),r.a.createElement("div",{className:p.a.page},r.a.createElement(l.b,{exact:!0,path:"/",render:function(){return r.a.createElement(l.a,{to:"/featured"})}}),r.a.createElement(l.b,{path:"/personal",component:Q}),r.a.createElement(l.b,{path:"/featured",component:V}),r.a.createElement(l.b,{path:"/callback",component:G})),r.a.createElement(_e,null))}),he=a(53),ye={token:null,device_id:null},we=Object(he.b)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;return"setToken"===t.type?Object(A.a)({},e,{token:t.payload}):"setDeviceId"===t.type?Object(A.a)({},e,{device_id:t.payload}):e}),Ee=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ge(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(s.a,{store:we},r.a.createElement(ke,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");Ee?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ge(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ge(t,e)})}}()},21:function(e,t,a){e.exports={cover:"Playlist_cover__y5Yjp",card:"Playlist_card__3hnBW",close:"Playlist_close__3Osp5",wrapper:"Playlist_wrapper__abev-",header:"Playlist_header__1M6CQ",title:"Playlist_title__3jD1v",description:"Playlist_description__rECMM",createdBy:"Playlist_createdBy__3JM2W",author:"Playlist_author__16Tlt",lineBreak:"Playlist_lineBreak__2Xx8a",section:"Playlist_section__10c-y"}},32:function(e,t,a){e.exports={table:"Tracks_table__1EeZa",header:"Tracks_header__3N9mH",title:"Tracks_title__1wK7U",content:"Tracks_content__3S6fp"}},45:function(e,t,a){e.exports={row:"Track_row__2oXZy",elm:"Track_elm__BDULk",artist:"Track_artist__WH3Qv"}},91:function(e,t,a){e.exports={page:"App_page__3q1Qz",section:"App_section__b4E85"}},92:function(e,t,a){e.exports={header:"Header_header__1v0yI"}},94:function(e,t,a){e.exports={container:"PlaylistList_container__2_ej2"}},95:function(e,t,a){e.exports=a.p+"static/media/close.c3770f64.svg"},96:function(e,t,a){e.exports={container:"Card_container__2U80V"}},97:function(e,t,a){e.exports={backdrop:"Modal_backdrop__1mf1y"}}},[[110,1,2]]]);
//# sourceMappingURL=main.074b0079.chunk.js.map